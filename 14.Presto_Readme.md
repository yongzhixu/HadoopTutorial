[TOC] 

## Install Presto Query

- [installing guide](https://prestodb.io/docs/current/installation/deployment.html#installing-presto)

```sh
weget https://repo1.maven.org/maven2/com/facebook/presto/presto-server/0.267/presto-server-0.267.tar.gz
tar -xvf XXX.tar.gz
```

#### Config

https://prestodb.io/docs/current/installation/deployment.html

```
for config sample, goes to github repository
```

#### Set up command line

https://prestodb.io/docs/current/installation/cli.html

```shell
-- download the excutable file to the presto-server-version/bin/ folder
wget https://repo1.maven.org/maven2/com/facebook/presto/presto-cli/0.267/presto-cli-0.267-executable.jar
-- rename
mv presto-cli-0.267-executable.jar presto
cd ..
bin/launcher start

-- visit presto web, port been assigned through config file
http://127.0.0.1:8090/
```



#### Connect to hive from CLI

- [HIVE Connector](https://www.tutorialspoint.com/apache_presto/apache_presto_hive_connector.htm)

```
bin/presto --server 127.0.0.1:8090 --catalog hive
```

- query hive via presto

```sql
show tables from foodmart;
select * from foodmart.movies limit 10;
```

- you can check the execution history from http://127.0.0.1:8090/



- quit

```sh
quit
bin/launcher stop
```



### Access via shell

#### Query

```sql
-- show tables
!tables

CREATE TABLE IF NOT EXISTS us_population(
	state CHAR(2) NOT NULL, 
	city VARCHAR NOT NULL,
	population BIGINT
	CONSTRAINT my_pk PRIMARY KEY (state, city)
	);
-- double check
!tables;

-- insert data
UPSERT INTO US_POPULATION VALUES ('NY', 'New York', 8823192);
UPSERT INTO US_POPULATION VALUES ('CA', 'los Angeles', 3823192);

SELECT * FROM US_POPULATION WHERE city ='CA'

-- clean table 
DROP TABLE US_POPULATION;

!quit;
```



### Phoenix with pig

#### Prepare table

-- phoenix shell

```SQL
CREATE TABLE IF NOT EXISTS users(
	USERID INTEGER NOT NULL, 
	AGE INTEGER, 
	GENDER CHAR(1),
	OCCUPATION VARCHAR,
	ZIP VARCHAR 
	CONSTRAINT my_pk PRIMARY KEY (USERID)
	);

!tables
-- run pig script
pig 13_phoenix.pig
```

### Import data into hbase using phoenix

[13_phoenix.pig.pig](https://github.com/yongzhixu/HadoopTutorial/blob/main/13_phoenix.pig)



### Q

#### Pig-Hbase vs Pig-Phoenix-HBase

```markdown
The answer will depends on where we want to result to be saved, 
in the first case it can be stored in HDFS and 
in the second case it will be stored in HBase 
**so** this is based on the destination.
```

